# مدير المودمات - Modem Pool Manager

برنامج لإدارة مودمات متعددة (حتى 12 مودم) وتنفيذ أوامر USSD بشكل متزامن.

## المميزات

- **اكتشاف تلقائي للمودمات**: البحث عن منافذ ZTE Diagnostics تلقائياً
- **دعم حتى 12 مودم**: قابل للتوسع حسب عدد المودمات المتصلة
- **تنفيذ متزامن**: تنفيذ أوامر USSD على جميع المودمات في وقت واحد (Parallel)
- **واجهة عربية**: واجهة مستخدم كاملة بالعربية
- **أوامر سريعة**: إمكانية حفظ أوامر USSD متكررة للوصول السريع

## متطلبات التشغيل

- Windows 10/11
- .NET 8.0 SDK أو أحدث
- مودمات ZTE متصلة عبر USB

## طريقة التشغيل

### الطريقة 1: التشغيل من Visual Studio
1. افتح المشروع في Visual Studio 2022
2. اضغط F5 للتشغيل

### الطريقة 2: التشغيل من سطر الأوامر
```bash
cd ModemPoolManager
dotnet restore
dotnet run
```

### الطريقة 3: إنشاء ملف تنفيذي
```bash
dotnet publish -c Release -r win-x64 --self-contained true
```

## كيفية الاستخدام

1. **تحديث المنافذ**: اضغط على زر "تحديث المنافذ" للبحث عن المودمات المتصلة
2. **جلب الأرقام**: اضغط على "جلب الأرقام" للحصول على أرقام الهواتف من كل مودم
3. **تنفيذ USSD**: 
   - أدخل كود USSD في الحقل (مثل `*100#`)
   - اضغط "تنفيذ على الكل" لتنفيذ الأمر على جميع المودمات المحددة

## أوامر AT المستخدمة

| الأمر | الوصف |
|-------|-------|
| `AT` | اختبار الاتصال |
| `AT+CNUM` | جلب رقم الهاتف |
| `AT+CSQ` | قوة الإشارة |
| `AT+COPS?` | اسم المشغل |
| `AT+CUSD=1,"code",15` | تنفيذ USSD |

## البنية البرمجية

```
ModemPoolManager/
├── Models/
│   ├── Modem.cs           # نموذج المودم
│   └── UssdResult.cs      # نموذج نتيجة USSD
├── Services/
│   └── ModemService.cs    # خدمة إدارة المودمات
├── ViewModels/
│   └── MainViewModel.cs   # ViewModel للواجهة
├── Converters/
│   └── InverseBoolConverter.cs
├── MainWindow.xaml        # واجهة المستخدم
├── MainWindow.xaml.cs
├── App.xaml
└── App.xaml.cs
```

## الفرق عن البرنامج القديم

| الميزة | البرنامج القديم | البرنامج الجديد |
|--------|----------------|-----------------|
| عدد المودمات | 6 فقط | حتى 12 (قابل للتوسع) |
| التنفيذ | متسلسل (Sequential) | متزامن (Parallel) |
| الواجهة | VB.NET WinForms | C# WPF حديث |
| الأداء | بطيء | سريع جداً |

## ملاحظات تقنية

- يستخدم `System.IO.Ports` للاتصال بالمودمات
- يستخدم `async/await` و `Task.WhenAll` للتنفيذ المتزامن
- يستخدم نمط MVVM لفصل الواجهة عن المنطق
